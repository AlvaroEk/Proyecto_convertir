"use strict";var jwt=require("jsonwebtoken");function authenticate(e,t,r){var n=e.cookies.token;if(!n)return t.redirect("/login");try{var i=jwt.verify(n,process.env.ACCESS_TOKEN_SECRET);e.userId=i.userId,r()}catch(e){return t.redirect("/login")}}function generateToken(e){return jwt.sign({userId:e},process.env.ACCESS_TOKEN_SECRET,{expiresIn:"1h"})}module.exports={authenticate:authenticate,generateToken:generateToken};
//# sourceMappingURL=authMiddleware.min.js.map
