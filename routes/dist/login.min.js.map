{"version":3,"sources":["login.js"],"names":["express","require","router","Router","authMiddleware","passport","res","render","title","get","req","post","authenticate","user","id","failureFlash","token","httpOnly","secure","redirect"],"mappings":"aAAA,IAAMA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,SADjBH,SAAUC,QAAQ,YAGlBG,eAAiBH,QAAQ,oCAD/BC,OAAMG,IAAAA,IAAWJ,SAAAA,EAAOK,GAKtBA,EAAIC,OAAO,QAAS,CAAEC,MAAO,qBAD/BN,OAAOO,KAAI,IAAKJ,SAACK,aAAa,QAAA,CAC5BJ,gBAAW,SAAWE,cAAO,IAA7B,SAAAE,EAAAJ,GAIFJ,IAAOS,EAAPP,eAA0BQ,cAAaF,EAASG,KAAAC,IAE9CC,EAAAA,OAAAA,QAAcC,EAAA,CAAAC,UAAA,EAAAC,QAAA,IAEdZ,EAAAa,SAAA,OAG6BF,OAAAA,QAAUf","file":"login.min.js","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst passport = require('passport');\r\nconst authMiddleware = require('../middlewares/authMiddleware.js')\r\n\r\n// Ruta para mostrar el formulario de login\r\nrouter.get('/', (req, res) => {\r\n  res.render('login', { title: 'Iniciar sesiÃ³n' });\r\n});\r\n\r\n\r\nrouter.post('/', passport.authenticate('local', {\r\n  failureRedirect: '/login',\r\n  failureFlash: true\r\n}), (req, res) => {\r\n  // Si se autentica correctamente, crea un token JWT\r\n  const token = authMiddleware.generateToken(req.user.id);\r\n\r\n  res.cookie('token', token, { httpOnly: true, secure: true });\r\n\r\n  res.redirect('/');\r\n});\r\n\r\nmodule.exports = router;\r\n"]}