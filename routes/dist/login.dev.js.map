{"version":3,"sources":["login.js"],"names":["express","require","router","Router","passport","authMiddleware","get","req","res","render","title","post","authenticate","failureRedirect","failureFlash","token","generateToken","user","id","cookie","httpOnly","secure","redirect","module","exports"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;;AACA,IAAMC,QAAQ,GAAGH,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAMI,cAAc,GAAGJ,OAAO,CAAC,kCAAD,CAA9B,C,CAEA;;;AACAC,MAAM,CAACI,GAAP,CAAW,GAAX,EAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC5BA,EAAAA,GAAG,CAACC,MAAJ,CAAW,OAAX,EAAoB;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAApB;AACD,CAFD;AAKAR,MAAM,CAACS,IAAP,CAAY,GAAZ,EAAiBP,QAAQ,CAACQ,YAAT,CAAsB,OAAtB,EAA+B;AAC9CC,EAAAA,eAAe,EAAE,QAD6B;AAE9CC,EAAAA,YAAY,EAAE;AAFgC,CAA/B,CAAjB,EAGI,UAACP,GAAD,EAAMC,GAAN,EAAc;AAChB;AACA,MAAMO,KAAK,GAAGV,cAAc,CAACW,aAAf,CAA6BT,GAAG,CAACU,IAAJ,CAASC,EAAtC,CAAd;AAEAV,EAAAA,GAAG,CAACW,MAAJ,CAAW,OAAX,EAAoBJ,KAApB,EAA2B;AAAEK,IAAAA,QAAQ,EAAE,IAAZ;AAAkBC,IAAAA,MAAM,EAAE;AAA1B,GAA3B;AAEAb,EAAAA,GAAG,CAACc,QAAJ,CAAa,GAAb;AACD,CAVD;AAYAC,MAAM,CAACC,OAAP,GAAiBtB,MAAjB","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst passport = require('passport');\r\nconst authMiddleware = require('../middlewares/authMiddleware.js')\r\n\r\n// Ruta para mostrar el formulario de login\r\nrouter.get('/', (req, res) => {\r\n  res.render('login', { title: 'Iniciar sesiÃ³n' });\r\n});\r\n\r\n\r\nrouter.post('/', passport.authenticate('local', {\r\n  failureRedirect: '/login',\r\n  failureFlash: true\r\n}), (req, res) => {\r\n  // Si se autentica correctamente, crea un token JWT\r\n  const token = authMiddleware.generateToken(req.user.id);\r\n\r\n  res.cookie('token', token, { httpOnly: true, secure: true });\r\n\r\n  res.redirect('/');\r\n});\r\n\r\nmodule.exports = router;\r\n"],"file":"login.dev.js"}